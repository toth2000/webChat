(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{238:function(e,t,n){},404:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),i=n(22),r=n.n(i),s=(n(238),n(21)),o=n(71),d=n(442),l=n(446),u=n(207),j=n(90),b=n(58),h=(Object(u.a)({apiKey:"AIzaSyBCmSxRTmvHf-NWVRevGb5F5j4ifZTuE9Y",authDomain:"webchat-72740.firebaseapp.com",databaseURL:"https://webchat-72740-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"webchat-72740",storageBucket:"webchat-72740.appspot.com",messagingSenderId:"837698544528",appId:"1:837698544528:web:c70e0549c7908fb763c915",measurementId:"G-L4ZBY6WBC3"}),Object(j.b)()),f=Object(b.a)(),O=n(1),v=n.n(O),p=n(4),x=n(438),m=n(440),g=n(435),C=Object(g.a)({container:{textAlign:"center"}}),I=n(10),y=function(){return Object(I.jsx)("svg",{style:{width:"20px",height:"20px"},viewBox:"0 0 24 24",children:Object(I.jsx)("path",{fill:"currentColor",d:"M21.35,11.1H12.18V13.83H18.69C18.36,17.64 15.19,19.27 12.19,19.27C8.36,19.27 5,16.25 5,12C5,7.9 8.2,4.73 12.2,4.73C15.29,4.73 17.1,6.7 17.1,6.7L19,4.72C19,4.72 16.56,2 12.1,2C6.42,2 2.03,6.8 2.03,12C2.03,17.05 6.16,22 12.25,22C17.6,22 21.5,18.33 21.5,12.91C21.5,11.76 21.35,11.1 21.35,11.1V11.1Z"})})},w=function(){var e=C(),t=function(){var e=Object(p.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(b.d)(Object(b.b)(f,"users/"+t.uid),{name:t.displayName,uid:t.uid,email:t.email,profile_picture:t.photoURL});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n=function(){var e=Object(p.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===h.currentUser){e.next=3;break}return alert("Already Signed In"),e.abrupt("return");case 3:Object(j.c)(h,new j.a).then((function(e){var n=e.user;console.log("user",n),t(n)})).catch((function(e){alert("Sign In error. Please try again later"),console.log("Firebase Auth getAuth",e)}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(I.jsxs)(x.a,{className:e.container,maxWidth:"lg",children:[Object(I.jsx)("h1",{children:"Sign In To Continue"}),Object(I.jsx)(m.a,{variant:"contained",onClick:n,startIcon:Object(I.jsx)(y,{}),children:"Sign In With Google"})]})},k=Object(g.a)({grid:{color:"white",backgroundColor:"purple"}}),N=n(447),U=n(76),E=n(15),S=n(117),B=n.n(S),T=Object(g.a)({inputGrid:{gap:"8px"},input:{width:"70%"},messageGrid:{width:"auto",backgroundColor:"#ecf0bd"},scrollToBottom:{padding:"15px",height:500,width:600,marginTop:"8px",marginBottom:"8px"}}),G=n(441),L=n(225),R=n.n(L),F=n(154),A=n.n(F),W=Object(g.a)({sentcontainer:{display:"flex",justifyContent:"flex-end",gap:"4px",marginBottom:"8px"},messageText:{wordBreak:"break-word"},receivedcontainer:{display:"flex",justifyContent:"flex-start",gap:"4px",marginBottom:"8px"},sentTextContainer:{paddingLeft:"8px",paddingRight:"8px",justifyItems:"flexEnd",backgroundColor:"#c041c4",borderRadius:"8px"},receiveTextContainer:{paddingLeft:"8px",paddingRight:"8px",justifyItems:"flexEnd",backgroundColor:"#7a2cd4",borderRadius:"8px"},timeText:{color:"black"},seenIcon:{color:"blue"}}),M=function(e){var t=e.msg,n=e.currentUid,a=W();return Object(c.useEffect)((function(){if((null===t||void 0===t?void 0:t.receiverUid)===n&&"seen"!==(null===t||void 0===t?void 0:t.status)){var e={};e["messages/".concat(null===t||void 0===t?void 0:t.chatId,"/").concat(null===t||void 0===t?void 0:t.messageId,"/status")]="seen",Object(E.h)(Object(E.e)(f),e)}}),[t]),Object(c.useEffect)((function(){if((null===t||void 0===t?void 0:t.receiverUid)!==n&&"seen"!==(null===t||void 0===t?void 0:t.status)&&"delivereed"!==(null===t||void 0===t?void 0:t.status)){var e=Object(E.e)(f,"delivered/".concat(null===t||void 0===t?void 0:t.receiverUid,"/").concat(null===t||void 0===t?void 0:t.chatId,"/").concat(null===t||void 0===t?void 0:t.messageId));console.log("msg",t),Object(E.c)(e,(function(e){if(!e.exists()){var n={};n["messages/".concat(null===t||void 0===t?void 0:t.chatId,"/").concat(null===t||void 0===t?void 0:t.messageId,"/status")]="delivered",Object(E.h)(Object(E.e)(f),n)}}))}}),[]),Object(I.jsxs)("div",{className:(null===t||void 0===t?void 0:t.senderUid)===n?a.sentcontainer:a.receivedcontainer,children:[Object(I.jsxs)("div",{className:(null===t||void 0===t?void 0:t.senderUid)===n?a.sentTextContainer:a.receiveTextContainer,children:[Object(I.jsx)("p",{className:a.messageText,children:t.text}),(null===t||void 0===t?void 0:t.senderUid)===n&&Object(I.jsxs)(G.a,{children:["seen"===(null===t||void 0===t?void 0:t.status)&&Object(I.jsx)(A.a,{className:a.seenIcon}),"delivered"===(null===t||void 0===t?void 0:t.status)&&Object(I.jsx)(A.a,{className:a.deliveredIcon}),"sent"===(null===t||void 0===t?void 0:t.status)&&Object(I.jsx)(R.a,{className:a.sentIcon})]})]}),Object(I.jsx)("p",{className:a.timeText,children:B()(t.time).fromNow()})]})},P=function(e){var t=e.currentUid,n=e.otherUid,a=e.chatId,i=T(),r=Object(c.useState)(""),o=Object(s.a)(r,2),l=o[0],u=o[1],j=Object(c.useState)(null),b=Object(s.a)(j,2),h=b[0],O=b[1];Object(c.useEffect)((function(){var e=!0,t=Object(E.e)(f,"messages/".concat(a));return Object(E.c)(t,(function(t){try{var n=t.val();e&&O(n)}catch(c){console.log("Messages useEffect fetch Message",c)}})),function(){return e=!1}}),[a]);var v=function(e){if(l){var c=Object(E.e)(f,"messages/".concat(a)),i=Object(E.d)(c,"message").key,r={senderUid:t,receiverUid:n,status:"sent",chatId:a,messageId:i,text:l,time:B()().toDate()},s={};s["messages/".concat(a,"/").concat(i)]=r,s["delivered/".concat(n,"/").concat(a,"/").concat(i)]=!1,u(""),Object(E.h)(Object(E.e)(f),s)}};return Object(I.jsxs)(d.a,{className:i.messageGrid,container:!0,direction:"column",justifyContent:"flex-start",alignItems:"center",children:[Object(I.jsx)(U.a,{className:i.scrollToBottom,children:h&&Object.keys(h).map((function(e){return Object(I.jsx)(M,{currentUid:t,msg:h[e]},e)}))}),Object(I.jsxs)(d.a,{className:i.inputGrid,container:!0,direction:"row",justifyContent:"center",alignItems:"center",children:[Object(I.jsx)(N.a,{className:i.input,variant:"outlined",type:"text",margin:"dense",value:l,disabled:!a,onChange:function(e){u(e.target.value)},onKeyPress:function(e){return"Enter"===e.key?v():null}}),Object(I.jsx)(m.a,{variant:"contained",color:"secondary",onClick:function(e){return v()},children:"Send"})]})]})},D=Object(g.a)((function(e){return{root:{flexGrow:1},paper:{height:140,width:100},control:{padding:e.spacing(2)},scroll:{height:500,width:"100%",marginTop:"8px",marginBottom:"8px"},inputGrid:{gap:"8px"},input:{width:"65%"},chatGrid:{backgroundColor:"#ade0d4",width:"auto"}}})),H=n(448),K=n(443),V=Object(g.a)({grid:{gap:"8px",marginBottom:"15px",backgroundColor:"gray",padding:"5px",borderRadius:"15px",cursor:"pointer","&:hover":{backgroundColor:"#c2c7ed"},"&:hover:active":{backgroundColor:"#cecfd6"},"&:hover:visited":{backgroundColor:"#8088c4"}},active:{gap:"8px",marginBottom:"15px",backgroundColor:"#d45d87",padding:"5px",borderRadius:"15px"},image:{marginLeft:"15px",height:"48px",width:"48px",borderRadius:"30px"}}),Y=function(e){var t=e.chatId,n=e.uid,a=e.setChatId,i=e.setOtherUid,r=e.activeChat,o=V(),l=Object(c.useState)(null),u=Object(s.a)(l,2),j=u[0],b=u[1];return Object(c.useEffect)((function(){var e=Object(E.e)(f,"users/".concat(n));Object(E.c)(e,(function(e){var t=e.val();b(t)}))}),[]),Object(I.jsxs)(d.a,{className:r?o.active:o.grid,container:!0,justifyContent:"flex-start",alignItems:"center",onClick:function(){a&&i&&(i(n),a(t))},children:[j?Object(I.jsx)("img",{className:o.image,src:j.profile_picture,alt:"profile_picture"}):Object(I.jsx)(H.a,{className:o.image}),Object(I.jsx)(K.a,{variant:"h6",children:j?j.name:"User Name"})]})},Z=function(e){var t=e.user,n=e.setChatId,a=e.setOtherUid,i=e.chatId,r=e.chat,o=e.setChat,l=D(),u=Object(c.useState)(""),j=Object(s.a)(u,2),b=j[0],h=j[1];Object(c.useEffect)((function(){var e=Object(E.e)(f,"chats/".concat(null===t||void 0===t?void 0:t.uid));Object(E.c)(e,(function(e){try{var t=e.val();o(t)}catch(n){console.log("Chat.js useEffect fetch chat",n)}}))}),[null===t||void 0===t?void 0:t.uid]);var O=function(e){var n=Object(E.e)(f,"chats/".concat(t.uid,"/").concat(e));Object(E.c)(n,(function(n){if(n.exists())alert("User is already available in your chat.");else{var c={chatId:"".concat(t.uid,"-").concat(e)},a={};a["chats/".concat(t.uid,"/").concat(e)]=c,a["chats/".concat(e,"/").concat(t.uid)]=c,h(""),Object(E.h)(Object(E.e)(f),a)}}),{onlyOnce:!0})},v=function(){if(t.email!==b){var e=Object(E.e)(f,"users");Object(E.c)(e,(function(e){if(e.exists())try{for(var t in e.val())if(e.val()[t].email===b)return void O(e.val()[t].uid)}catch(n){console.log("checkIfUserExists method",n)}alert("Invalid Email, User does not exist")}))}else alert("You can not add yourself")};return Object(I.jsx)(d.a,{className:l.chatGrid,container:!0,direction:"row",justifyContent:"center",alignItems:"flex-start",children:Object(I.jsxs)(x.a,{maxWidth:"xs",children:[Object(I.jsx)("h4",{children:"Conversations"}),Object(I.jsx)(U.a,{mode:"top",className:l.scroll,children:r&&Object.keys(r).map((function(e){return Object(I.jsx)(Y,{activeChat:!(!i||i!==r[e].chatId),uid:e,chatId:r[e].chatId,setChatId:n,setOtherUid:a},e)}))}),Object(I.jsxs)(d.a,{className:l.inputGrid,container:!0,direction:"row",justifyContent:"space-between",alignItems:"center",children:[Object(I.jsx)(N.a,{className:l.input,variant:"outlined",label:"Enter Email",type:"text",value:b,margin:"dense",onChange:function(e){h(e.target.value)},onKeyPress:function(e){return"Enter"===e.key?v():null}}),Object(I.jsx)(m.a,{variant:"outlined",onClick:v,children:"Add User"})]})]})})},_=Object(g.a)((function(e){return{root:{flexGrow:1},paper:{height:140,width:100},control:{padding:e.spacing(2)},scroll:{height:500,width:"100%",marginTop:"8px",marginBottom:"8px"},inputGrid:{gap:"8px"},input:{width:"65%"},statusGrid:{backgroundColor:"#e8b62c",width:"auto"}}})),J=function(e){var t=e.chatList,n=e.currentUid,a=Object(E.e)(f,"status/".concat(n)),i=_(),r=Object(c.useState)([]),o=Object(s.a)(r,2),l=o[0],u=o[1];return Object(c.useEffect)((function(){Object(E.c)(Object(E.e)(f,"/status"),(function(e){try{if(!e.exists)return;var c=e.val(),a=[];Object.keys(t).forEach((function(e){c[e]&&e!==n&&a.push(e)})),u(a)}catch(i){}}))}),[t]),Object(c.useEffect)((function(){var e=Object(E.e)(f,"/info/connected");Object(E.c)(e,(function(e){!1!==e.val()&&Object(E.b)(a).remove(a).then((function(){Object(E.g)(a,!0)}))}))}),[n]),Object(c.useEffect)((function(){var e=Object(E.e)(f,"delivered/".concat(n));Object(E.c)(e,(function(t){t.exists()&&Object(E.f)(e)}),[n])})),Object(I.jsx)(d.a,{className:i.statusGrid,container:!0,direction:"row",justifyContent:"center",alignItems:"flex-start",children:Object(I.jsxs)(x.a,{maxWidth:"xs",children:[Object(I.jsx)("h4",{children:"Active Users"}),Object(I.jsx)(U.a,{mode:"top",className:i.scroll,children:l.map((function(e){return Object(I.jsx)(Y,{uid:e},e)}))})]})})},z=n(444),q=n(445),Q=n(226),X=n(449),$=Object(g.a)({title:{color:"#FFF",textDecoration:"none"},toolbar:{display:"flex",justifyContent:"space-between"},userBox:{display:"flex",gap:"25px",alignItems:"center"},userName:{"@media screen and (max-width:800px)":{display:"none"}},avatar:{cursor:"pointer"}}),ee=function(e){var t=e.user,n=e.setChatId,a=$(),i=Object(c.useState)({open:!1,anchorE1:null}),r=Object(s.a)(i,2),d=r[0],l=r[1],u=function(){l({open:!1,anchorE1:null})};return Object(I.jsx)(z.a,{position:"sticky",children:Object(I.jsxs)(q.a,{className:a.toolbar,children:[Object(I.jsx)(K.a,{className:a.title,variant:"h6",children:"WebChat"}),Object(I.jsxs)("div",{className:a.userBox,children:[Object(I.jsx)(K.a,{variant:"h6",className:a.userName,children:null===t||void 0===t?void 0:t.displayName}),t&&Object(I.jsx)(H.a,{src:null===t||void 0===t?void 0:t.photoURL,className:a.avatar,"aria-controls":"simple-menu","aria-haspopup":"false",onClick:function(e){l({open:!0,anchorE1:e.currentTarget})}}),Object(I.jsx)(Q.a,{id:"simple-menu",anchorEl:d.anchorE1,keepMounted:!0,open:Boolean(d.open),onClose:u,children:Object(I.jsx)(X.a,{onClick:function(){var e=null===t||void 0===t?void 0:t.uid;Object(b.c)(Object(b.b)(f,"status/".concat(e))).then((function(){Object(o.e)(h),n(null)})),u()},children:"Logout"})})]})]})})},te=function(){var e=k(),t=Object(c.useState)(null),n=Object(s.a)(t,2),a=n[0],i=n[1],r=Object(c.useState)(!0),u=Object(s.a)(r,2),j=u[0],b=u[1],f=Object(c.useState)(null),O=Object(s.a)(f,2),v=O[0],p=O[1],x=Object(c.useState)(null),m=Object(s.a)(x,2),g=m[0],C=m[1],y=Object(c.useState)(null),N=Object(s.a)(y,2),U=N[0],E=N[1];return Object(c.useEffect)((function(){Object(o.c)(h,(function(e){i(e||null),b(!1)}))}),[]),Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(ee,{user:a,setChatId:p}),Object(I.jsxs)(d.a,{className:e.grid,container:!0,direction:"column",alignItems:"center",justifyContent:"center",style:{height:"92vh"},children:[j&&Object(I.jsx)(l.a,{}),a?Object(I.jsx)(I.Fragment,{children:Object(I.jsxs)(d.a,{container:!0,direction:"row",alignItems:"stretch",justifyContent:"center",children:[Object(I.jsx)(Z,{chat:U,setChat:E,chatId:v,user:a,setChatId:p,setOtherUid:C}),Object(I.jsx)(P,{currentUid:null===a||void 0===a?void 0:a.uid,chatId:v,otherUid:g}),Object(I.jsx)(J,{chatList:U,currentUid:null===a||void 0===a?void 0:a.uid})]})}):Object(I.jsx)(w,{})]})]})};var ne=function(){return Object(I.jsx)(te,{})},ce=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,450)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),c(e),a(e),i(e),r(e)}))};r.a.render(Object(I.jsx)(a.a.StrictMode,{children:Object(I.jsx)(ne,{})}),document.getElementById("root")),ce()}},[[404,1,2]]]);
//# sourceMappingURL=main.8fdf00fb.chunk.js.map